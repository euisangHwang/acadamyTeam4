<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="egovframework.example.upload.service.impl.UploadMapper">
	
	<!-- 메인 조회 -->
	<insert id="insertFile" parameterType="egovMap">
		<selectKey resultType="Integer" keyProperty="seqNo" order="BEFORE">
		SELECT nvl(MAX(SEQ_NO),0)+1AS seqNo
		FROM upload
		</selectKey>
		INSERT INTO upload
		(SEQ_NO,
		SIGN_TRG_NO,
		ORIGINAL_FILE_NAME,
		F_FILE_NAME,
		FILE_PATH,
		IMAGE_SIZE)
		VALUES
		(#{seqNo},
		'hanq',
		#{jinjjaName},
		#{RfileName},
		#{RfilePath},
		#{fileSize})
	</insert>

	<select id="selectFiles" parameterType="map" resultType="egovMap">
      SELECT  SEQ_NO, 
            SIGN_TRG_NO,
             ORIGINAL_FILE_NAME,
               F_FILE_NAME,
               FILE_PATH,
               IMAGE_SIZE
        FROM  upload
       where  1 = 1
      <if test='signTrgNo != null'>
         AND SIGN_TRG_NO = #{signTrgNo}
      </if>
      <if test='filename != null'>
         AND ORIGINAL_FILE_NAME = #{filename}
      </if>
   </select>
</mapper>