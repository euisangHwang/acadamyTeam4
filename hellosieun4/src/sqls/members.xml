<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"   
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="sieun.Members"> 

<select id="selectOneMember"
parameterType="integer"
resultType="map">
SELECT M.memberCode, M.id, M.pw, M.tel, M.name, M.address, M.homeimg, 
(SELECT pPath FROM picture WHERE pictureCode = M.homeimg) pPath,
(SELECT pFullName FROM picture WHERE pictureCode = M.homeimg) pFullName
FROM member M
WHERE M.memberCode= #{_parameter}
</select>

<select id="isUser"
parameterType = "map"
resultType="integer">
SELECT MEMBERCODE mCode FROM MEMBER WHERE ID = #{uid} AND PW = #{upass}
</select>

<select id="isUserIdDuplicate"
parameterType = "String"
resultType="integer">
SELECT COUNT(*) FROM MEMBER WHERE ID = #{_parameter}
</select>

<select id="findIdByPhone"
parameterType = "String"
resultType="String">
SELECT ID FROM MEMBER WHERE TEL = #{_parameter}
</select>

<select id="checkPhone"
parameterType = "map"
resultType="integer">
SELECT COUNT(*) FROM MEMBER WHERE ID = #{id} AND TEL = #{phone}
</select>

<insert id="insertMember" parameterType="map">
INSERT INTO MEMBER (ID, PW, TEL, NAME, ADDRESS, HOMEIMG)
VALUES(#{id},#{pw},#{tel},#{name},#{address}, #{homeimg})
</insert>

<update id="updateMember" parameterType="map">
UPDATE MEMBER
SET ID 		= #{id}, 
	PW	    = #{pw}, 
	TEL 	= #{tel}, 
	NAME	= #{name}, 
	ADDRESS = #{address}
	<if test="homeimg != 0">
	,HOMEIMG = #{homeimg}
	</if>
WHERE MEMBERCODE   = #{memberCode}
</update>

<update id="updatePw" parameterType="map">
UPDATE MEMBER
SET PW	    = #{newPw}
WHERE ID   = #{id}
</update>


 </mapper>